Having trouble with convergence with the full model.
Strip back to intercept only models and build up to find the problem

grInt = int, grSigma = int, converge = yes, estimate NA = yes
grInt = yoy, grSigma = int, converge = no, estimate = no

add isYOY initials for observed lengths
grInt = yoy, grSigma = int, converge = no, estimate NA = no

add isYOY initials for all lengths - get error
grInt = yoy, grSigma = int, converge = no, estimate NA = no

grInt = river, grSigma = int, converge = yes, estimate NA = yes
!!! so the problem is with isYOY

add isYOY as a beta, rather than an index
grInt = river+river*isYOY1, grSigma = int, converge = no, estimate NA = no
== isYOY problem is not with the indexing

Thinking the squared term on stdLength beta could acct for isYOY
Leaving isYOY out of estimation
grInt = river*season*species*11 betas, grSigma = int, converge = no, estimate NA = no

removed isYOY from the model completely, it's not doing anything, but could it screw the rest up?
grInt = river*season*species*11 betas, grSigma = int, converge = no, estimate NA = no

removed betas to see if r*s*s int works
grInt = river*season*species, grSigma = int, converge = yes, estimate NA = yes

added stdLength beta
grInt = river*season*species + len beta, grSigma = int, converge = no, estimate NA = no

replaced length with lengthDATA in the stdLength calculations
grInt = river*season*species + len beta, grSigma = int, converge =no , estimate NA =no

removed stdLength betas, kept flowTemp betas
grInt = river*season*species + flow*Temp beta, grSigma = int, converge =yes , estimate NA =yes

try 10000 adaptation with 11 betas
grInt = river*season*species + flow*Temp*stdLen*count beta, grSigma = int, converge = no, estimate NA = no

code ISYOY as data, remove all stdLength betas, full interaction on grBetas
grInt = river*season*species*isYOY + flow*Temp*stdLen*count beta, grSigma = int, converge = yes, estimate NA = yes

Add model on expectedGRSigma

Thought I could look at size-dep growth after tracing gr, but all fish for a given sample get the same gr so can't look at size-dep growth
adding stdLength[] back into the model. It worked in the JAE model. Adding year back to grInt and sigmaInt. Didn't work

Calculate lengthDATAStd trying that as the ind variable for beta. didn't work with length[ evalRows[i] + 1 ] <- length[ evalRows[i] ] + gr[ evalRows[i] ]

Moved length[ evalRows[i] ] + gr[ evalRows[i] ] into the dnorm so length doesn't get defined as a variable - didn't help

made a simulation and got the same result - poor mixing with stdLength as a beta. Doing many adaptations (20000) made the model mix reasonably. 60000 adaptations for the big model didn't mix. Maybe need many more?

Trying 10000 fish for 50000 obs with the sim to see if big model doens't mix because of high numFish/adaptations ratio.

####
Key was the '9' for the precision of length(). THis actually controlled the variance of each measure. Model mioxes well when we take out the observation part.
#####

Model selection:

int main, dic = -4485.878 , mix  = A
int main intRE, dic = -4267.325, mix  = A-
int main intRE betaRE, dic = -4255.394, mix  = A-
int main main^2 intRE betaRE, dic = -5084.402, mix  = A-
int main main^2 intRE betaRE (fix yoy=2,season=2 to 0), dic = -2232.782, mix  = B
main main^2 intRE betaRE IndRE (fix yoy=2,season=2 to 0), dic = 6143.798  , mix  = C
int main main^2 main-2ways intRE betaRE (fix yoy=2,season=2 to 0), dic = -3001.243, mix  = B
int main main^2 main-2ways main-3ways intRE betaRE (fix yoy=2,season=2 to 0), dic = -2337.868 , mix = C
int main main^2 main-2ways main-3ways intRE betaRE, grSigma[,,,] (fix yoy=2,season=2 to 0), dic =  , mix = C
yoy1, season 2 not fixed, int main main^2 main-2ways main-3ways intRE betaRE, grSigma[,,,] , dic =  , mix = C
yoy1, season 2 not fixed, int main main^2 main-2ways intRE betaRE, grSigma[,,,] , dic =  , mix = C
yoy1, season 2 not fixed, int main main^2 main-2ways intRE betaRE,  , dic =  , mix =


# trying runs with rmse as indicator, model5
int main, mix = A, rmse = 0.09295182
int main sigma[,,,], mix = A, rmse = 0.09496348
int main sigma[,,,] betaRE, mix = A, rmse = 0.09477582
int main sigma[,,,] betaRE intRE, mix = A, rmse = 0.0950708
int main sigma[,,,] betaRE intRE main^2, mix = A except for YOY=1, season2 , rmse = 0.08947765
int main sigma[,,,] betaRE intRE main^2 [fix yoy1+season2], mix = C, rmse = 0.1153313
int main sigma[,,,] betaRE intRE main^2 main-2ways, mix = A, rmse = 0.08665695
int main sigma[,,,] betaRE intRE main^2 main-2ways main-3ways, mix = A, rmse = 0.08532076
int main sigma[,,,] betaRE intRE main^2 main-2ways main-3ways indRE, mix = A, rmse = 0.07755313
int main sigma[,,,] betaRE intRE main^2 main-2ways main-3ways indRE sigmaBeta, mix = F, rmse = big

# mixing was actually poor for the 2nd to last model above. Chain 3 was different
# run with initials for grInt and grBeta, bump adaptaion phase from 1000 to 5000
int main sigma[,,,] betaRE intRE main^2 main-2ways main-3ways indRE, mix = C, rmse = 0.07932732
int main sigma[,,,] betaRE intRE main^2 main-2ways main-3ways , mix = C, rmse =

# chains not mixing. Took yoy out of hierarchical means and sds for grInt,grBeta and grSigma. model6
int main sigma[,,,] betaRE intRE main^2 main-2ways main-3ways sigmaRE, mix = A, rmse = 0.08617891
int main sigma[,,,] betaRE intRE main^2 main-2ways main-3ways sigmaRE indRE, mix = A, rmse = 0.07775984
int main sigma[,,,] betaRE intRE main^2 main-2ways main-3ways sigmaRE indRE sigmaBeta sigmaBetaRE, mix = slow, rmse = 0.0790462
# add inits for sigmaInt and sigmaBeta

